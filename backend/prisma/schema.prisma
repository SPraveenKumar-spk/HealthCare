generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  role      String
  createdAt DateTime @default(now())

  patient   Patient?
  doctor    Doctor?
}

model Patient {
  id        Int       @id @default(autoincrement())
  userId    Int       @unique
  fullName  String
  phone     String?
  age       Int?
  gender    String?
  address   String?

  user         User     @relation(fields: [userId], references: [id])
  appointments Appointment[]
  prescriptions Prescription[]
}

model Doctor {
  id        Int       @id @default(autoincrement())
  userId    Int       @unique
  fullName  String
  specialization String
  phone     String?

  user         User     @relation(fields: [userId], references: [id])
  appointments Appointment[]
  prescriptions Prescription[]
  schedules      DoctorSchedule[]
}

model Appointment {
  id          Int      @id @default(autoincrement())
  patientId   Int
  doctorId    Int
  appointmentDate DateTime
  status      String   @default("scheduled")
  notes       String?

  patient     Patient  @relation(fields: [patientId], references: [id])
  doctor      Doctor   @relation(fields: [doctorId], references: [id])
  prescriptions Prescription[]
}

model Prescription {
  id        Int       @id @default(autoincrement())
  appointmentId Int
  doctorId  Int
  patientId Int
  medicines String?
  advice    String?
  date      DateTime @default(now())

  appointment Appointment @relation(fields: [appointmentId], references: [id])
  patient     Patient     @relation(fields: [patientId], references: [id])
  doctor      Doctor      @relation(fields: [doctorId], references: [id])
}

model DoctorSchedule {
  id        Int      @id @default(autoincrement())
  doctorId  Int
  dayOfWeek String   // e.g. "Monday"
  startTime String   // e.g. "10:00 AM"
  endTime   String   // e.g. "12:00 PM"

  doctor    Doctor   @relation(fields: [doctorId], references: [id])
}

